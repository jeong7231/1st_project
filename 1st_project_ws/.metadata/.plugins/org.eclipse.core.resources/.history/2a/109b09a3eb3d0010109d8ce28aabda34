/*
 * mfrc522.h
 *
 *  Created on: May 31, 2025
 *      Author: aiot24_
 */

#ifndef __MFRC522_H
#define __MFRC522_H

#include "stm32f4xx_hal.h"
#include <stdbool.h>

#define MFRC522_CS_PORT GPIOA
#define MFRC522_CS_PIN  GPIO_PIN_4

#define MFRC522_RST_PORT GPIOB
#define MFRC522_RST_PIN  GPIO_PIN_0

// 명령어
#define PCD_IDLE              0x00
#define PCD_AUTHENT          0x0E
#define PCD_RECEIVE          0x08
#define PCD_TRANSMIT         0x04
#define PCD_TRANSCEIVE       0x0C
#define PCD_RESETPHASE       0x0F
#define PCD_CALCCRC          0x03

// 카드 명령어
#define PICC_REQIDL          0x26
#define PICC_ANTICOLL        0x93
#define PICC_SElECTTAG       0x93
#define PICC_READ            0x30

// 레지스터
#define ControlReg            0x0C
#define ErrorReg              0x06
#define FIFOLevelReg          0x0A
#define FIFODataReg           0x09
#define CommandReg            0x01
#define CommIEnReg            0x02
#define CommIrqReg            0x04
#define BitFramingReg         0x0D
#define TxControlReg          0x14
#define ModeReg               0x11
#define TxASKReg              0x15
#define TModeReg              0x2A
#define TPrescalerReg         0x2B
#define TReloadRegL           0x2D
#define TReloadRegH           0x2C
#define VersionReg            0x37

extern SPI_HandleTypeDef hspi1;

void MFRC522_Init(void);
bool MFRC522_IsCard(void);
bool MFRC522_ReadCardSerial(uint8_t *uid);

#endif

